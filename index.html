<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eclipse Simulation â€“ Solar & Lunar</title>
<style>
body {
  margin: 0;
  background: white;
  font-family: 'Poppins', sans-serif;
  text-align: center;
  color: #222;
}
h1 {
  margin-top: 15px;
  color: #f5b700;
  font-size: 28px;
}
canvas {
  display: block;
  margin: 20px auto;
  background: radial-gradient(circle at center, #fff 40%, #f9f9f9 100%);
  border: 1px solid #ccc;
  border-radius: 10px;
}
.controls {
  margin: 10px 0;
}
button, select {
  margin: 5px;
  padding: 8px 14px;
  border: none;
  border-radius: 8px;
  background-color: #f5b700;
  color: white;
  cursor: pointer;
  transition: 0.2s;
  font-size: 14px;
}
button:hover, select:hover {
  background-color: #ffcb00;
}
.info {
  margin-top: 8px;
  font-size: 14px;
}
</style>
</head>
<body>

<h1>ðŸŒž Eclipse Simulation â€“ Solar & Lunar ðŸŒ‘</h1>

<div class="controls">
  <select id="mode">
    <option value="solar">Solar Eclipse</option>
    <option value="lunar">Lunar Eclipse</option>
  </select>
  <button id="startBtn">Start</button>
  <button id="pauseBtn">Pause</button>
  <button id="resetBtn">Reset</button>
  <label>Speed:</label>
  <input id="speedSlider" type="range" min="0.5" max="3" step="0.1" value="1">
</div>

<canvas id="canvas" width="700" height="500"></canvas>

<div class="info" id="infoText"></div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const modeSelect = document.getElementById('mode');
const infoText = document.getElementById('infoText');
const startBtn = document.getElementById('startBtn');
const pauseBtn = document.getElementById('pauseBtn');
const resetBtn = document.getElementById('resetBtn');
const speedSlider = document.getElementById('speedSlider');

let mode = 'solar';
let running = false;
let t = 0;
let speed = 1;

modeSelect.onchange = () => { mode = modeSelect.value; resetSim(); };
speedSlider.oninput = () => { speed = parseFloat(speedSlider.value); };

startBtn.onclick = () => { running = true; };
pauseBtn.onclick = () => { running = false; };
resetBtn.onclick = () => { resetSim(); };

function resetSim() {
  running = false;
  t = 0;
  infoText.innerText = '';
  draw();
}

function circleOverlapArea(r1, r2, d) {
  if (d >= r1 + r2) return 0;
  if (d <= Math.abs(r1 - r2)) return Math.PI * Math.min(r1, r2)**2;
  const a1 = r1*r1*Math.acos((d*d + r1*r1 - r2*r2)/(2*d*r1));
  const a2 = r2*r2*Math.acos((d*d + r2*r2 - r1*r1)/(2*d*r2));
  const a3 = 0.5*Math.sqrt((-d+r1+r2)*(d+r1-r2)*(d-r1+r2)*(d+r1+r2));
  return a1 + a2 - a3;
}

function drawSolar() {
  const cx = canvas.width/2, cy = canvas.height/2;
  const rSun = 120, rMoon = 40;
  const maxDist = rSun + rMoon + 40;
  const dist = (Math.cos(t) * maxDist);
  const moonX = cx + dist, moonY = cy;

  ctx.fillStyle = 'white';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Sun (with gradient + limb darkening)
  const grad = ctx.createRadialGradient(cx, cy, rSun*0.2, cx, cy, rSun);
  grad.addColorStop(0, '#fffcc2');
  grad.addColorStop(1, '#f5b700');
  ctx.fillStyle = grad;
  ctx.beginPath(); ctx.arc(cx, cy, rSun, 0, 2*Math.PI); ctx.fill();

  // Moon
  ctx.fillStyle = '#444';
  ctx.beginPath(); ctx.arc(moonX, moonY, rMoon, 0, 2*Math.PI); ctx.fill();

  // Overlap fraction
  const d = Math.abs(cx - moonX);
  const overlap = circleOverlapArea(rSun, rMoon, d);
  const fraction = overlap / (Math.PI*rSun*rSun);
  let phaseText = '';

  if (fraction === 0) phaseText = 'No Eclipse';
  else if (fraction < 0.3) phaseText = 'Partial Eclipse';
  else if (fraction < 0.95) phaseText = 'Deep Partial';
  else if (rMoon < rSun * 0.98) phaseText = 'Annular Eclipse (Ring of Fire)';
  else if (fraction >= 0.95 && rMoon >= rSun*0.98) phaseText = 'Total Eclipse (Diamond Ring)';
  else phaseText = 'Eclipse Phase';

  infoText.innerText = `ðŸŒž Solar Eclipse | Obscured: ${(fraction*100).toFixed(1)}% | Phase: ${phaseText}`;
}

function drawLunar() {
  const cx = canvas.width/2, cy = canvas.height/2;
  const rEarth = 80, rMoon = 40, rSun = 180;
  const shadowLength = 350; 
  const umbraRadius = rEarth - (rSun - rEarth) * (rEarth / shadowLength);
  const penumbraRadius = umbraRadius + 50;
  const moonDist = Math.cos(t) * (penumbraRadius + rMoon + 30);
  const moonX = cx + moonDist, moonY = cy;

  ctx.fillStyle = 'white';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Penumbra shadow
  ctx.fillStyle = 'rgba(255,200,0,0.1)';
  ctx.beginPath(); ctx.arc(cx, cy, penumbraRadius, 0, 2*Math.PI); ctx.fill();

  // Umbra shadow
  ctx.fillStyle = 'rgba(100,100,100,0.25)';
  ctx.beginPath(); ctx.arc(cx, cy, umbraRadius, 0, 2*Math.PI); ctx.fill();

  // Earth
  ctx.fillStyle = '#2271b3';
  ctx.beginPath(); ctx.arc(cx, cy, rEarth, 0, 2*Math.PI); ctx.fill();

  // Moon
  ctx.fillStyle = '#aaa';
  ctx.beginPath(); ctx.arc(moonX, moonY, rMoon, 0, 2*Math.PI); ctx.fill();

  const d = Math.abs(cx - moonX);
  const inUmbra = d < umbraRadius + rMoon;
  const inPenu = d < penumbraRadius + rMoon && d >= umbraRadius + rMoon;

  let phaseText = '';
  if (d > penumbraRadius + rMoon) phaseText = 'No Eclipse';
  else if (inPenu) phaseText = 'Partial Penumbral Eclipse';
  else if (inUmbra && d > umbraRadius - rMoon) phaseText = 'Partial Umbra Eclipse';
  else if (d <= umbraRadius - rMoon) phaseText = 'Total Lunar Eclipse';
  else phaseText = 'Lunar Eclipse Phase';

  infoText.innerText = `ðŸŒ• Lunar Eclipse | Shadow Distance: ${d.toFixed(1)} | Phase: ${phaseText}`;
}

function draw() {
  if (mode === 'solar') drawSolar();
  else drawLunar();
}

function animate() {
  if (running) {
    t += 0.02 * speed;
    draw();
  }
  requestAnimationFrame(animate);
}

draw();
animate();
</script>
</body>
</html>
