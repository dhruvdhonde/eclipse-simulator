<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Solar & Lunar Eclipse Simulator</title>
<style>
body {
  margin: 0;
  background: #fffdf5;
  color: #222;
  font-family: 'Poppins', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
}
h1 {
  color: #f1b400;
  margin-top: 20px;
  font-size: 2em;
  letter-spacing: 1px;
}
canvas {
  border: 1px solid #f1b400;
  border-radius: 10px;
  background: radial-gradient(circle at center, #fefefe 70%, #faf6e9 100%);
  margin: 20px 0;
}
.controls {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
  margin-bottom: 15px;
}
button, select, input[type=range] {
  background: #fff;
  border: 1px solid #f1b400;
  border-radius: 8px;
  padding: 8px 14px;
  color: #222;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}
button:hover, select:hover {
  background: #f1b400;
  color: #fff;
}
.slider-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin: 5px;
}
label {
  font-size: 0.8em;
  color: #555;
}
#info {
  max-width: 700px;
  text-align: center;
  font-size: 0.9em;
  color: #333;
  margin-top: 10px;
}
</style>
</head>
<body>
<h1>Solar & Lunar Eclipse Interactive Simulator</h1>

<canvas id="simCanvas" width="800" height="500"></canvas>

<div class="controls">
  <select id="mode">
    <option value="solar">Solar Eclipse</option>
    <option value="lunar">Lunar Eclipse</option>
  </select>
  <button id="startBtn">▶ Start</button>
  <button id="pauseBtn">⏸ Pause</button>
  <button id="resetBtn">⟲ Reset</button>
</div>

<div class="controls">
  <div class="slider-container">
    <label>Speed</label>
    <input type="range" id="speedSlider" min="1" max="10" value="3">
  </div>
  <div class="slider-container">
    <label>Moon Distance</label>
    <input type="range" id="moonDist" min="250" max="450" value="350">
  </div>
  <div class="slider-container">
    <label>Sun Radius</label>
    <input type="range" id="sunRadius" min="60" max="100" value="80">
  </div>
</div>

<div id="info">Use the sliders to adjust simulation parameters. Switch between Solar and Lunar Eclipse modes. Observe the Earth's shadow, umbra, penumbra, and the ring of fire / diamond ring effect during totality.</div>

<script>
const canvas = document.getElementById('simCanvas');
const ctx = canvas.getContext('2d');

let running = false;
let t = 0;
let speed = 3;
let mode = 'solar';
let moonDist = 350;
let sunRadius = 80;

document.getElementById('mode').onchange = e => mode = e.target.value;
document.getElementById('startBtn').onclick = () => running = true;
document.getElementById('pauseBtn').onclick = () => running = false;
document.getElementById('resetBtn').onclick = () => { t = 0; running = false; };
document.getElementById('speedSlider').oninput = e => speed = +e.target.value;
document.getElementById('moonDist').oninput = e => moonDist = +e.target.value;
document.getElementById('sunRadius').oninput = e => sunRadius = +e.target.value;

function drawSun(x, y, r) {
  const grad = ctx.createRadialGradient(x, y, r*0.2, x, y, r);
  grad.addColorStop(0, '#fff7c0');
  grad.addColorStop(0.8, '#f1b400');
  grad.addColorStop(1, '#d48b00');
  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.arc(x, y, r, 0, 2*Math.PI);
  ctx.fill();
}

function drawEarth(x, y, r) {
  const grad = ctx.createRadialGradient(x - r/3, y - r/3, r*0.2, x, y, r);
  grad.addColorStop(0, '#bde0ff');
  grad.addColorStop(1, '#004477');
  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.arc(x, y, r, 0, 2*Math.PI);
  ctx.fill();
}

function drawMoon(x, y, r) {
  const grad = ctx.createRadialGradient(x - r/2, y - r/2, r*0.2, x, y, r);
  grad.addColorStop(0, '#eaeaea');
  grad.addColorStop(1, '#a0a0a0');
  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.arc(x, y, r, 0, 2*Math.PI);
  ctx.fill();
}

function drawUmbra(x, y, angle, len, baseR, tipR, color) {
  ctx.beginPath();
  ctx.moveTo(x - baseR, y);
  ctx.lineTo(x - tipR, y - len);
  ctx.lineTo(x + tipR, y - len);
  ctx.lineTo(x + baseR, y);
  ctx.closePath();
  ctx.fillStyle = color;
  ctx.globalAlpha = 0.25;
  ctx.fill();
  ctx.globalAlpha = 1.0;
}

function drawLightCurve() {
  const phase = Math.abs(Math.sin(t/50));
  const flux = 1 - 0.9 * Math.exp(-10 * (phase - 0.5)**2);
  ctx.fillStyle = "#f1b400";
  ctx.fillRect(50, 450, flux*700, 10);
  ctx.fillStyle = "#000";
  ctx.fillText(`Relative Flux: ${(flux*100).toFixed(1)}%`, 320, 440);
}

function drawDiamondRing(x, y, sunR, moonR, sep) {
  if (sep < Math.abs(sunR - moonR) + 2) {
    ctx.beginPath();
    ctx.arc(x + sunR * 0.6, y, 8, 0, 2*Math.PI);
    ctx.fillStyle = "#fff4b2";
    ctx.shadowBlur = 25;
    ctx.shadowColor = "#ffeb80";
    ctx.fill();
    ctx.shadowBlur = 0;
  }
}

function simulateSolar() {
  const cx = 400, cy = 250;
  const sunR = sunRadius;
  const moonR = sunR * 0.9;
  const dx = Math.cos(t/100)*moonDist - 150;

  drawSun(cx, cy, sunR);
  drawMoon(cx + dx, cy, moonR);
  drawDiamondRing(cx, cy, sunR, moonR, Math.abs(dx));
  drawLightCurve();
}

function simulateLunar() {
  const cx = 400, cy = 250;
  const earthR = 60;
  const moonR = 25;
  const dist = 250;
  const offset = Math.sin(t/100)*100;

  drawSun(cx, cy + 200, 50);
  drawUmbra(cx, cy, 0, dist, earthR, 20, '#000');
  drawEarth(cx, cy, earthR);
  drawMoon(cx + offset, cy - dist, moonR);
  drawLightCurve();
}

function animate() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = "#222";
  ctx.font = "14px Poppins";
  if (mode === 'solar') simulateSolar();
  else simulateLunar();
  if (running) t += speed;
  requestAnimationFrame(animate);
}
animate();
</script>
</body>
</html>
